---
title: "Tidy Your Data:<br>Exploring {`tidyr`} and {`dplyr`}"
subtitle: "IOC-R Week 8"
date: "2025-03-10"
date-format: " "
format:
  revealjs: 
    toc: true
    toc-title: "Plan"
    toc-depth: 1
    slide-number: true
    preview-links: auto
    logo: ../../images/logoInforBio_fond_blanc_small.png
    css: ../custom.css
  # pdf:
  #   toc: true
echo: true
categories: 
  - week08
  - slides
image: images/preview_w8.png
---

# Recap `apply()` and `lapply()`

## `apply()` and `lapply()` {.smaller}

::: {.columns}
::: {.column}

```r
apply(X, MARGIN, FUN)
```

- `X`: a matrix or a data frame (coerced to a matrix)
- `MARGIN`: 1 for rows and 2 for columns
- `FUN`: the function to be applied

```{r}
mat <- matrix(1:9, nrow = 3)
apply(mat, 1, sum)
```

:::
::: {.column .fragment}

```r
lapply(X, FUN)
```

- `X`: a list or a vector
- `FUN`: the function to be applied

```{r}
my_list <- list(1, 2:3, 4:6)
lapply(my_list, sum)
sapply(my_list, sum) # simplified output
```

:::
:::

# Tidy Data with {`tidyr`} and {`dplyr`}

## Why Do We Need {`tidyverse`}? {.smaller}

Base R can be cumbersome â†’ {`tidyverse`} makes it simpler, with core packages such as:

  - [ggplot2](https://ggplot2.tidyverse.org/) (see session 5);
  - [**dplyr**](https://dplyr.tidyverse.org/): helps to manipulate data;
  - [**tidyr**](https://tidyr.tidyverse.org/): helps to structure data;
  - [readr](https://readr.tidyverse.org/): import data into R;
  - [stringr](https://stringr.tidyverse.org/): helps to manipulate strings (see session 9);
  - ...

```r
## install the core tidyverse packages
install.packages("tidyverse")

## load the core tidyverse packages
library(tidyverse)
```

```{r}
#| echo: false

library(tidyverse)
```

## The Pipe `|>` Operator {.smaller}

The pipe operator `|>` helps to execute codes in sequential, it allows passing the input to the first argument of the function on the right-hand side.

::: {.columns}
::: {.column .fragment}

```{r}
# create a vector
x <- c(-3, -5, NA, 8)

# calculation with nested function
sqrt(mean(abs(x), na.rm = TRUE))

# alternative
# use intermediate variable for each step
abs_vals <- abs(x)
mean_val <- mean(abs_vals, na.rm = TRUE)
result <- sqrt(mean_val)
result
```

:::
::: {.column .fragment}

```{r}
# use pipe to make code easier to read
abs(x) |> mean(na.rm = TRUE) |> sqrt()

## or each function in one line
abs(x) |>
  mean(na.rm = TRUE) |>
  sqrt()
```

:::
:::


:::{.callout-tip appearance="minimal" .fragment}
- `|>` native pipe operator, built into base R (version 4.1+)
- `%>%` pipe from the {`magrittr`} package
:::

## What is a `tibble`? {.smaller}

A "modern" data frame.


- Data imported by {`readr`} is in tibble format.
```{r}
head(readr::read_csv("../exos_data/toy_DEanalysis.csv"), 3)
```

- Convert a data frame or a matrix into a tibble.

```{r}
head(as_tibble(iris), 3)
```


:::{.callout-note appearance="minimal"}
`chr`: character; `dbl`: double; `int`: integer; `fct`: factor; `lgl`: logical; `dttm`: time/date
:::


# Manipulate Data with {`dplyr`}

## {`dplyr`} - Selection {.smaller}

Cheat sheet: <https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf>

```{r}
as_tibble(iris) |> head(3) |> select(Species)
```



## The {`dplyr`} Package {.smaller}

Cheat sheet: <https://github.com/rstudio/cheatsheets/blob/main/data-transformation.pdf>

## The {`tidyr`} Package {.smaller}

Cheat sheet: <https://github.com/rstudio/cheatsheets/blob/master/tidyr.pdf>



# Let's Practice !

## Today's Goals

- 
- 
- 
- 
